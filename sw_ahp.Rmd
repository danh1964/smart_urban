---
title: "M√¥ h√¨nh SWOT-AHP cho smart city management"
subtitle: "03 b∆∞·ªõc th·ª±c hi·ªán SWOT-AHP"
author: "Vo Thanh Danh"
output:
  html_document:
    code_download: true
    df_print: paged
    toc: true
    toc_float:
      collapsed: false
      smooth_scroll: false
    toc_depth: 4
    number_sections: true
    code_folding: "show"
    theme: "cosmo"
    highlight: "monochrome"
  pdf_document: default
  word_document: default
---


<style>
h1.title {font-size: 18pt; color: DarkBlue;} 
body, h1, h2, h3, h4 {font-family: "Palatino", serif;}
body {font-size: 12pt;}
/* Headers */
h1,h2,h3,h4,h5,h6{font-size: 14pt; color: #00008B;}
body {color: #333333;}
a, a:hover {color: #8B3A62;}
pre {font-size: 12px;}
</style>


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


# C√†i ƒë·∫∑t v√† g·ªçi c√°c th∆∞ vi·ªán c·∫ßn thi·∫øt


```{r}
###### cai d·∫°t "ahp" neu chua √≠ntall
# options(repos = c(CRAN = "https://cran.rstudio.com"))
# install.packages("remotes")
# 
# pkg_ahp <- c("ahp")
# 
# remotes::install_github("gluc/ahp", dependencies = TRUE)
library(ahp)
```


# Load data

```{r data}

```



# B∆Ø·ªöC 1: T·∫°o ma tr·∫≠n so s√°nh c·∫∑p ƒë√¥i SWOT theo thang ƒëi·ªÉm Saaty

## C√°c b∆∞·ªõc th·ª±c hi·ªán

1Ô∏è‚É£ Nh·∫≠p th∆∞ vi·ªán h·ªó tr·ª£ AHP.

2Ô∏è‚É£ X√¢y d·ª±ng ma tr·∫≠n so s√°nh c·∫∑p cho t·ª´ng nh√≥m:

Strengths (S) - ƒêi·ªÉm m·∫°nh

Weaknesses (W) - ƒêi·ªÉm y·∫øu

Opportunities (O) - C∆° h·ªôi

Threats (T) - Th√°ch th·ª©c

3Ô∏è‚É£ T√≠nh tr·ªçng s·ªë ∆∞u ti√™n c·ªßa t·ª´ng ti√™u ch√≠ trong m·ªói nh√≥m.

4Ô∏è‚É£ Ki·ªÉm tra t√≠nh nh·∫•t qu√°n (CR < 0.1 ƒë·ªÉ ƒë·∫£m b·∫£o k·∫øt qu·∫£ h·ª£p l√Ω).

5Ô∏è‚É£ Xu·∫•t k·∫øt qu·∫£ tr·ªçng s·ªë cho t·ª´ng nh√≥m.


```{r}
# A. üìå Lap ma tran 
# 1Ô∏è‚É£ Ma tr·∫≠n so s√°nh c·∫∑p cho nh√≥m "Strengths (S)"
S_matrix <- matrix(c(
  1, 3, 7, 5,  # S1 so v·ªõi (S1, S2, S3, S4)
  1/3, 1, 5, 3,  # S2 so v·ªõi (S1, S2, S3, S4)
  1/7, 1/5, 1, 1/3,  # S3 so v·ªõi (S1, S2, S3, S4)
  1/5, 1/3, 3, 1  # S4 so v·ªõi (S1, S2, S3, S4)
), nrow = 4, byrow = TRUE)

rownames(S_matrix) <- colnames(S_matrix) <- c("S1", "S2", "S3", "S4")

# 2Ô∏è‚É£ Ma tr·∫≠n so s√°nh c·∫∑p cho nh√≥m "Weaknesses (W)"
W_matrix <- matrix(c(
  1, 5, 3, 7,  
  1/5, 1, 1/3, 3,  
  1/3, 3, 1, 5,  
  1/7, 1/3, 1/5, 1  
), nrow = 4, byrow = TRUE)

rownames(W_matrix) <- colnames(W_matrix) <- c("W1", "W2", "W3", "W4")

# 3Ô∏è‚É£ Ma tr·∫≠n so s√°nh c·∫∑p cho nh√≥m "Opportunities O)"
O_matrix <- matrix(c(
  1, 7, 5, 3,  
  1/7, 1, 1/3, 1/5,  
  1/5, 3, 1, 1/3,  
  1/3, 5, 3, 1  
), nrow = 4, byrow = TRUE)

rownames(O_matrix) <- colnames(O_matrix) <- c("O1", "O2", "O3", "O4")
print(O_matrix)  # Ki·ªÉm tra xem ma tr·∫≠n c√≥ ƒë∆∞·ª£c t·∫°o kh√¥ng

# 4Ô∏è‚É£ Ma tr·∫≠n so s√°nh c·∫∑p cho nh√≥m "Threats (T)"
T_matrix <- matrix(c(
  1, 3, 5, 7,  
  1/3, 1, 1/5, 1/3,  
  1/5, 5, 1, 3,  
  1/7, 3, 1/3, 1  
), nrow = 4, byrow = TRUE)

rownames(T_matrix) <- colnames(T_matrix) <- c("T1", "T2", "T3", "T4")

ls()  # Li·ªát k√™ t·∫•t c·∫£ bi·∫øn trong m√¥i tr∆∞·ªùng hi·ªán t·∫°i

# B. üìå H√ÄM T√çNH TR·ªåNG S·ªê V√Ä KI·ªÇM TRA NH·∫§T QU√ÅN
calculate_weights <- function(matrix, group_name) {
  weights <- ahp::CalculatePairwiseMatrix(matrix)
  consistency_ratio <- ahp::CalculateConsistencyRatio(matrix)
  
  cat("\nüìä Tr·ªçng s·ªë ∆∞u ti√™n cho nh√≥m:", group_name, "\n")
  print(weights)
  cat("üìà Ch·ªâ s·ªë nh·∫•t qu√°n (CR) =", consistency_ratio, "\n")
  
  if (consistency_ratio < 0.1) {
    cat("‚úÖ Ma tr·∫≠n c√≥ t√≠nh nh·∫•t qu√°n.\n")
  } else {
    cat("‚ö†Ô∏è Ma tr·∫≠n c√≥ th·ªÉ ch∆∞a nh·∫•t qu√°n, c·∫ßn ƒëi·ªÅu ch·ªânh.\n")
  }
}

# C. üìå Ch·∫°y h√†m t√≠nh tr·ªçng s·ªë cho t·ª´ng nh√≥m
ls("package:ahp")

calculate_weights <- function(matrix, name) {
  eigen_res <- eigen(matrix)  # T√≠nh gi√° tr·ªã ri√™ng
  weights <- eigen_res$vectors[, 1] / sum(eigen_res$vectors[, 1])  # Chu·∫©n h√≥a
  cat("\nTr·ªçng s·ªë cho nh√≥m", name, ":\n")
  print(weights)
}

#
calculate_weights(S_matrix, "Strengths (S)")
calculate_weights(W_matrix, "Weaknesses (W)")
calculate_weights(O_matrix, "Opportunities (O)")
calculate_weights(T_matrix, "Threats (T)")

```


## üìå Gi·∫£i th√≠ch Code

1Ô∏è‚É£ T·∫°o ma tr·∫≠n so s√°nh c·∫∑p cho t·ª´ng nh√≥m (S, W, O, T)

D·ªØ li·ªáu nh·∫≠p theo thang ƒëo Saaty (1, 3, 5, 7, 9).

V√≠ d·ª•:
S1 quan tr·ªçng h∆°n S2 m·ªôt ch√∫t ‚Üí gi√° tr·ªã = 3.

S3 k√©m quan tr·ªçng h∆°n S1 r·∫•t nhi·ªÅu ‚Üí gi√° tr·ªã = 1/7.

2Ô∏è‚É£ H√†m calculate_weights() ƒë·ªÉ:

T√≠nh tr·ªçng s·ªë ∆∞u ti√™n c·ªßa t·ª´ng ti√™u ch√≠ b·∫±ng ph∆∞∆°ng ph√°p eigenvector.

Ki·ªÉm tra t√≠nh nh·∫•t qu√°n (CR < 0.1 l√† h·ª£p l√Ω).

In k·∫øt qu·∫£ tr·ªçng s·ªë cho t·ª´ng nh√≥m.

## üéØ K·∫øt lu·∫≠n

‚úÖ Code tr√™n gi√∫p t·∫°o ma tr·∫≠n so s√°nh c·∫∑p cho t·ª´ng nh√≥m SWOT.

‚úÖT inh tr·ªçng s·ªë c·ªßa t·ª´ng ti√™u ch√≠ b·∫±ng ph∆∞∆°ng ph√°p AHP.

‚úÖ Ki·ªÉm tra t√≠nh nh·∫•t qu√°n (CR) ƒë·ªÉ ƒë·∫£m b·∫£o k·∫øt qu·∫£ ƒë√°ng tin c·∫≠y.

‚úÖ K·∫øt qu·∫£ n√†y l√† ƒë·∫ßu v√†o ƒë·ªÉ ti·∫øp t·ª•c ph√¢n t√≠ch t·ªïng h·ª£p SWOT-AHP. üöÄ



# B∆∞·ªõc 2: So s√°nh gi·ªØa b·ªën nh√≥m ch√≠nh (S, W, O, T) ƒë·ªÉ x√°c ƒë·ªãnh tr·ªçng s·ªë c·ªßa t·ª´ng nh√≥m.

## üìå C√°c b∆∞·ªõc th·ª±c hi·ªán

1Ô∏è‚É£ C√†i ƒë·∫∑t & Load th∆∞ vi·ªán AHP.\

2Ô∏è‚É£ X√¢y d·ª±ng ma tr·∫≠n so s√°nh c·∫∑p gi·ªØa b·ªën nh√≥m ch√≠nh:

S (Strengths - ƒêi·ªÉm m·∫°nh)
W (Weaknesses - ƒêi·ªÉm y·∫øu)
O (Opportunities - C∆° h·ªôi)
T (Threats - Th√°ch th·ª©c)

3Ô∏è‚É£ T√≠nh tr·ªçng s·ªë c·ªßa t·ª´ng nh√≥m ch√≠nh.

4Ô∏è‚É£ Ki·ªÉm tra t√≠nh nh·∫•t qu√°n (CR < 0.1 ƒë·ªÉ ƒë·∫£m b·∫£o ma tr·∫≠n h·ª£p l√Ω).\

5Ô∏è‚É£ Xu·∫•t k·∫øt qu·∫£ tr·ªçng s·ªë cho b·ªën nh√≥m ch√≠nh.


```{r}
# 1Ô∏è‚É£ T·∫°o ma tr·∫≠n so s√°nh c·∫∑p gi·ªØa b·ªën nh√≥m ch√≠nh: S, W, O, T
SWOT_matrix <- matrix(c(
  1, 3, 5, 7,  # S so v·ªõi (S, W, O, T)
  1/3, 1, 3, 5,  # W so v·ªõi (S, W, O, T)
  1/5, 1/3, 1, 3,  # O so v·ªõi (S, W, O, T)
  1/7, 1/5, 1/3, 1  # T so v·ªõi (S, W, O, T)
), nrow = 4, byrow = TRUE)

# ƒê·∫∑t t√™n h√†ng v√† c·ªôt
rownames(SWOT_matrix) <- colnames(SWOT_matrix) <- c("S", "W", "O", "T")

# 2Ô∏è‚É£ H√†m t√≠nh tr·ªçng s·ªë v√† ki·ªÉm tra t√≠nh nh·∫•t qu√°n
calculate_weights <- function(matrix, group_name) {
  weights <- ahp::CalculatePairwiseMatrix(matrix)
  consistency_ratio <- ahp::CalculateConsistencyRatio(matrix)
  
  cat("\nüìä Tr·ªçng s·ªë ∆∞u ti√™n cho nh√≥m ch√≠nh:", group_name, "\n")
  print(weights)
  cat("üìà Ch·ªâ s·ªë nh·∫•t qu√°n (CR) =", consistency_ratio, "\n")
  
  if (consistency_ratio < 0.1) {
    cat("‚úÖ Ma tr·∫≠n c√≥ t√≠nh nh·∫•t qu√°n.\n")
  } else {
    cat("‚ö†Ô∏è Ma tr·∫≠n c√≥ th·ªÉ ch∆∞a nh·∫•t qu√°n, c·∫ßn ƒëi·ªÅu ch·ªânh.\n")
  }
}

# 3Ô∏è‚É£ T√≠nh tr·ªçng s·ªë cho b·ªën nh√≥m ch√≠nh SWOT
calculate_weights <- function(matrix, name) {
  eigen_res <- eigen(matrix)  # T√≠nh vector ri√™ng
  weights <- eigen_res$vectors[, 1]  # L·∫•y vector ri√™ng t∆∞∆°ng ·ª©ng v·ªõi gi√° tr·ªã ri√™ng l·ªõn nh·∫•t
  weights <- weights / sum(weights)  # Chu·∫©n h√≥a tr·ªçng s·ªë v·ªÅ t·ªïng 1

  cat("\nTr·ªçng s·ªë cho nh√≥m", name, ":\n")
  print(weights)
}

# G·ªçi h√†m cho ma tr·∫≠n SWOT
calculate_weights(SWOT_matrix, "SWOT")

```


## üìå Gi·∫£i th√≠ch Code

1Ô∏è‚É£ T·∫°o ma tr·∫≠n so s√°nh c·∫∑p gi·ªØa c√°c nh√≥m ch√≠nh (S, W, O, T)

D·ªØ li·ªáu nh·∫≠p theo thang ƒëo Saaty (1, 3, 5, 7, 9).

V√≠ d·ª•:
S quan tr·ªçng h∆°n W m·ªôt ch√∫t ‚Üí gi√° tr·ªã = 3.
S quan tr·ªçng h∆°n O nhi·ªÅu ‚Üí gi√° tr·ªã = 5.
S quan tr·ªçng h∆°n T r·∫•t nhi·ªÅu ‚Üí gi√° tr·ªã = 7.
C√°c gi√° tr·ªã ng∆∞·ª£c l·∫°i d√πng ngh·ªãch ƒë·∫£o (1/x).

2Ô∏è‚É£ H√†m calculate_weights() ƒë·ªÉ:

T√≠nh tr·ªçng s·ªë ∆∞u ti√™n c·ªßa t·ª´ng nh√≥m ch√≠nh.
Ki·ªÉm tra t√≠nh nh·∫•t qu√°n (CR < 0.1 l√† h·ª£p l√Ω).

In k·∫øt qu·∫£ tr·ªçng s·ªë cho b·ªën nh√≥m ch√≠nh.


## üéØ K·∫øt lu·∫≠n

‚úÖ Code tr√™n gi√∫p t·∫°o ma tr·∫≠n so s√°nh c·∫∑p gi·ªØa c√°c nh√≥m SWOT.

‚úÖ T√≠nh tr·ªçng s·ªë c·ªßa t·ª´ng nh√≥m b·∫±ng ph∆∞∆°ng ph√°p AHP.

‚úÖ Ki·ªÉm tra t√≠nh nh·∫•t qu√°n (CR) ƒë·ªÉ ƒë·∫£m b·∫£o k·∫øt qu·∫£ ƒë√°ng tin c·∫≠y.

‚úÖ K·∫øt qu·∫£ n√†y l√† ƒë·∫ßu v√†o cho B∆∞·ªõc 3 ƒë·ªÉ t·ªïng h·ª£p chi·∫øn l∆∞·ª£c! üöÄ



# B∆∞·ªõc 3: T·ªïng h·ª£p tr·ªçng s·ªë ƒë·ªÉ ra quy·∫øt ƒë·ªãnh chi·∫øn l∆∞·ª£c.

## üìå C√°c b∆∞·ªõc th·ª±c hi·ªán
1Ô∏è‚É£ Nh·∫≠p th∆∞ vi·ªán h·ªó tr·ª£ AHP.

2Ô∏è‚É£ T·∫°o ma tr·∫≠n so s√°nh c·∫∑p cho b·ªën nh√≥m ch√≠nh (S, W, O, T) d·ª±a tr√™n thang ƒëo Saaty.

3Ô∏è‚É£ T√≠nh tr·ªçng s·ªë ∆∞u ti√™n b·∫±ng ph∆∞∆°ng ph√°p eigenvector.

4Ô∏è‚É£ Ki·ªÉm tra t√≠nh nh·∫•t qu√°n c·ªßa ma tr·∫≠n.
5Ô∏è‚É£ Hi·ªÉn th·ªã k·∫øt qu·∫£.


```{r}
# 1Ô∏è‚É£ T·∫°o ma tr·∫≠n so s√°nh c·∫∑p cho nh√≥m ch√≠nh (S, W, O, T)
swot_matrix <- matrix(c(
  1, 7, 3, 9,  # S so v·ªõi (S, W, O, T)
  1/7, 1, 1/3, 3,  # W so v·ªõi (S, W, O, T)
  1/3, 3, 1, 7,  # O so v·ªõi (S, W, O, T)
  1/9, 1/3, 1/7, 1  # T so v·ªõi (S, W, O, T)
), nrow = 4, byrow = TRUE)

rownames(swot_matrix) <- colnames(swot_matrix) <- c("S", "W", "O", "T")

# 2Ô∏è‚É£ T√≠nh vector tr·ªçng s·ªë ∆∞u ti√™n (eigenvector)
calculate_weights <- function(matrix, name) {
  eigen_res <- eigen(matrix)  # T√≠nh eigenvalues v√† eigenvectors
  weights <- eigen_res$vectors[, 1]  # L·∫•y eigenvector t∆∞∆°ng ·ª©ng v·ªõi gi√° tr·ªã ri√™ng l·ªõn nh·∫•t
  weights <- Re(weights) / sum(Re(weights))  # Chu·∫©n h√≥a tr·ªçng s·ªë v·ªÅ t·ªïng 1

  cat("\nTr·ªçng s·ªë cho nh√≥m", name, ":\n")
  print(weights)
  
  return(weights)
}

# Ch·∫°y h√†m v·ªõi ma tr·∫≠n SWOT
swot_weights <- calculate_weights(swot_matrix, "SWOT")
swot_weights

# 3Ô∏è‚É£ Ki·ªÉm tra ch·ªâ s·ªë nh·∫•t qu√°n (Consistency Ratio - CR)
check_consistency <- function(matrix) {
  n <- nrow(matrix)  # S·ªë ti√™u ch√≠
  eigen_res <- eigen(matrix)  # T√≠nh eigenvalues
  lambda_max <- max(Re(eigen_res$values))  # L·∫•y gi√° tr·ªã ri√™ng l·ªõn nh·∫•t
  
  # T√≠nh ch·ªâ s·ªë kh√¥ng nh·∫•t qu√°n CI
  CI <- (lambda_max - n) / (n - 1)

  # B·∫£ng RI t·ª´ Saaty (1977)
  RI_values <- c(0, 0, 0.58, 0.90, 1.12, 1.24, 1.32, 1.41, 1.45, 1.49)
  RI <- ifelse(n <= length(RI_values), RI_values[n], NA)

  # T√≠nh CR
  CR <- ifelse(!is.na(RI) & RI != 0, CI / RI, NA)

  cat("Ch·ªâ s·ªë nh·∫•t qu√°n (CR):", CR, "\n")

  # Ki·ªÉm tra t√≠nh nh·∫•t qu√°n
  if (!is.na(CR) & CR < 0.1) {
    cat("‚úÖ Ma tr·∫≠n c√≥ t√≠nh nh·∫•t qu√°n t·ªët.\n")
  } else {
    cat("‚ö†Ô∏è Ma tr·∫≠n ch∆∞a ƒë·∫°t t√≠nh nh·∫•t qu√°n. C·∫ßn ƒëi·ªÅu ch·ªânh!\n")
  }

  return(CR)
}
# Ki·ªÉm tra t√≠nh nh·∫•t qu√°n cho ma tr·∫≠n SWOT
consistency_ratio <- check_consistency(swot_matrix)


# 4Ô∏è‚É£ Hi·ªÉn th·ªã tr·ªçng s·ªë cu·ªëi c√πng
cat("üåç Tr·ªçng s·ªë ∆∞u ti√™n c·ªßa c√°c nh√≥m SWOT:\n")
print(swot_weights)

```


## üìå Gi·∫£i th√≠ch Code

1Ô∏è‚É£ T·∫°o ma tr·∫≠n so s√°nh c·∫∑p cho nh√≥m SWOT:

S c√≥ tr·ªçng s·ªë cao h∆°n W, O, T.
W c√≥ tr·ªçng s·ªë th·∫•p h∆°n O, S.
O c√≥ tr·ªçng s·ªë cao h∆°n W, T.
T c√≥ tr·ªçng s·ªë th·∫•p nh·∫•t.

‚Üí D·ªØ li·ªáu d·ª±a theo thang ƒëo Saaty (1, 3, 5, 7, 9).

2Ô∏è‚É£ T√≠nh tr·ªçng s·ªë ∆∞u ti√™n b·∫±ng ph∆∞∆°ng ph√°p eigenvector.

3Ô∏è‚É£ Ki·ªÉm tra t√≠nh nh·∫•t qu√°n (CR < 0.1 l√† ƒë·∫°t y√™u c·∫ßu).

4Ô∏è‚É£ Xu·∫•t tr·ªçng s·ªë cho b·ªën nh√≥m S, W, O, T.



## üéØ K·∫øt lu·∫≠n

‚úÖ M√¥ h√¨nh SWOT-AHP gi√∫p ra quy·∫øt ƒë·ªãnh chi·∫øn l∆∞·ª£c d·ª±a tr√™n tr·ªçng s·ªë c·ªßa t·ª´ng nh√≥m (S, W, O, T).

‚úÖ Code tr√™n gi√∫p t√≠nh to√°n tr·ªçng s·ªë t·ªïng h·ª£p b·∫±ng AHP.

‚úÖ K·∫øt qu·∫£ cu·ªëi c√πng c√≥ th·ªÉ s·ª≠ d·ª•ng ƒë·ªÉ l·ª±a ch·ªçn chi·∫øn l∆∞·ª£c ph√π h·ª£p (SO, ST, WO, WT). üöÄ



end.